<!-- Explainer Modal Partial -->
<div x-show="explainerModal.open"
    class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm shadow-2xl"
    style="display: none;" @keydown.escape.window="explainerModal.open = false">
    <div class="relative w-full max-w-lg bg-slate-800 rounded-2xl shadow-2xl border border-white/10 p-8"
        @click.away="explainerModal.open = false">
        <div class="h-1.5 w-full bg-gradient-to-r from-indigo-500 to-purple-500 absolute top-0 left-0 rounded-t-2xl">
        </div>
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
                <div class="size-10 rounded-xl bg-indigo-500/20 flex items-center justify-center text-indigo-400">
                    <span class="material-symbols-outlined">psychology</span>
                </div>
                <div>
                    <h3 class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">
                        {{ 'AI Interpretation' if locale == 'en' else 'Interpretación IA' }}
                    </h3>
                    <p class="text-lg font-black text-white leading-tight"
                        x-text="explainerModal.title || (locale === 'en' ? 'Analyzing...' : 'Analizando...')">
                    </p>
                </div>
            </div>
            <button @click="explainerModal.open = false" class="text-slate-500 hover:text-white transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <!-- Loading State -->
        <div x-show="explainerModal.loading"
            class="py-12 text-center text-slate-500 animate-pulse flex flex-col items-center gap-4">
            <div class="w-12 h-12 border-4 border-indigo-500/20 border-t-indigo-500 rounded-full animate-spin"></div>
            <p class="text-sm font-medium">
                {{ 'Consulting AI engine...' if locale == 'en' else 'Consultando motor de IA...' }}
            </p>
        </div>

        <!-- Content State -->
        <div x-show="!explainerModal.loading && explainerModal.content" class="space-y-6">
            <div>
                <h4 class="text-[10px] font-bold text-indigo-400 uppercase tracking-widest mb-2">
                    {{ 'What it means' if locale == 'en' else 'Significado Real' }}
                </h4>
                <p class="text-slate-200 text-sm leading-relaxed" x-text="explainerModal.content?.what_it_means"></p>
            </div>

            <div class="grid grid-cols-1 gap-4">
                <div class="bg-slate-900/40 p-4 rounded-xl border border-white/5">
                    <h4 class="text-[10px] font-bold text-indigo-500/60 uppercase tracking-widest mb-1.5">
                        {{ 'Calculation' if locale == 'en' else 'Cómo se Calcula' }}
                    </h4>
                    <p class="text-slate-400 text-[11px] leading-relaxed italic"
                        x-text="explainerModal.content?.how_calculated"></p>
                </div>

                <template x-if="explainerModal.content?.business_impact">
                    <div
                        class="bg-emerald-500/5 p-4 rounded-xl border border-emerald-500/20 group hover:border-emerald-500/40 transition-colors">
                        <h4
                            class="text-[10px] font-bold text-emerald-400 uppercase tracking-widest mb-1.5 flex items-center gap-1.5">
                            <span class="material-symbols-outlined text-sm">payments</span>
                            {{ 'Business Impact' if locale == 'en' else 'Impacto en Tu Negocio' }}
                        </h4>
                        <p class="text-white text-sm font-semibold leading-relaxed"
                            x-text="explainerModal.content?.business_impact"></p>
                    </div>
                </template>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-8 pt-6 border-t border-white/5 text-right">
            <button @click="explainerModal.open = false"
                class="bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold py-2.5 px-8 rounded-xl transition-all shadow-lg shadow-indigo-600/20">
                {{ 'Understood' if locale == 'en' else 'Entendido' }}
            </button>
        </div>
    </div>
</div>